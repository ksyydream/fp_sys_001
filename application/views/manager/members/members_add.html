{{include file='manager/public/head.html'}}<body class="no-skin">{{include file='manager/public/header.html'}}<div class="main-container" id="main-container">    <script type="text/javascript">        try {            ace.settings.check('main-container', 'fixed')        } catch (e) {        }    </script>    {{include file='manager/public/sidebar.html'}}    <div class="main-content">        <div class="main-content-inner">            <!-- #section:basics/content.breadcrumbs -->            {{include file='manager/public/breadcrumbs.html'}}            <!-- /section:basics/content.breadcrumbs -->            <div class="page-content">                {{include file='manager/public/set.html'}}                <!-- /section:settings.box -->                <div class="row">                    <div class="col-xs-12">                        <!-- PAGE CONTENT BEGINS -->                        <form id="save_form" class="form-horizontal" action="" method="post">                            <input type="hidden" name="m_id" value="{{$data.m_id|default:''}}">                            <div class="space-4"></div>                            <div class="form-group">                                <label class="col-sm-1 control-label no-padding-right"> 管理员姓名 </label>                                <div class="col-sm-9">                                    <input type="text" name="rel_name" id="rel_name" placeholder="管理员姓名"                                           class="col-xs-10 col-sm-5" value="{{$data.rel_name|default:''}}">                                    <span class="help-inline col-xs-12 col-sm-7">                                                <span class="middle"></span>                                            </span>                                </div>                            </div>                            <div class="space-4"></div>                            <div class="form-group">                                <label class="col-sm-1 control-label no-padding-right"> 管理员手机号 </label>                                <div class="col-sm-9">                                    <input type="text" name="mobile" id="mobile" placeholder="管理员手机号"                                           class="col-xs-10 col-sm-5" value="{{$data.mobile|default:''}}">                                    <span class="help-inline col-xs-12 col-sm-7">                                                <span class="middle"></span>                                            </span>                                </div>                            </div>                            <div class="space-4"></div>                            <div class="form-group">                                <label class="col-sm-1 control-label no-padding-right" for="form-field-4"> 头像 </label>                                <div class="col-sm-9">                                    <div class="col-xs-10 col-sm-5">                                        <img style="width: 200px" id="imgShow" {{if !empty($data) }} src="/upload_files/head/{{$data.pic}}"{{else}}src="/manager_statics/images/touxiang.png"{{/if}}>                                        <input type="hidden" id="hidImgName" name="head" value="{{$data.pic|default:''}}" />                                    </div>                                    <span class="help-inline col-xs-12 col-sm-7">											</span>                                </div>                            </div>                            <div class="form-group">                                <label class="col-sm-1 control-label no-padding-right"> </label>                                <div class="col-sm-9">                                    <div class="col-xs-10 col-sm-5">                                        <div>                                            <button type="button" class="btn btn-primary" id="btnUploadImg">上传头像</button>                                        </div>                                    </div>                                    <span class="help-inline col-xs-12 col-sm-7">												<span class="middle">仅支持jpg、gif、png、bmp、jpeg，且小于2MB。</span></span>                                </div>                            </div>                            <div class="space-4"></div>                            <div class="form-group">                                <label class="col-sm-1 control-label no-padding-right"> 管理员职务 </label>                                <div class="col-sm-9 yy_m_7">                                    <input type="radio" name="level" {{if $data.level|default:0 == 1}}checked{{/if}} value="1" >总经理&nbsp;&nbsp;&nbsp;                                    <input type="radio" name="level" {{if $data.level|default:0 == 2}}checked{{/if}} value="2" >总监&nbsp;&nbsp;&nbsp;                                    <input type="radio" name="level" {{if $data.level|default:0 == 3}}checked{{/if}} value="3" >组员&nbsp;&nbsp;&nbsp;                                    <input type="radio" name="level" {{if $data.level|default:0 == 4}}checked{{/if}} value="4" >财务&nbsp;&nbsp;&nbsp;                                    <span class="lbl"></span>                                </div>                            </div>                            <div id="m_div_" {{if $data.level|default:0 != 3}}style="display: none"{{/if}} >                            <div class="space-4"></div>                            <div class="form-group">                                <label class="col-sm-1 control-label no-padding-right"> 所属总监 </label>                                <div class="col-sm-5">                                    <select name="sel_member_id" id="sel_member_id" style="width: 90%">                                        <option value="">-请选择-</option>                                        {{foreach from=$data.m_level_2 key=k item=v}}                                        <option value="{{$v.m_id}}" {{if $data.parent_id|default:-1 == $v.m_id}}selected{{/if}}>{{$v.rel_name}}-{{$v.mobile}}</option>                                        {{/foreach}}                                    </select>                                </div>                            </div>                            </div>                            <div class="space-4"></div>                            <div class="form-group">                                <label class="col-sm-1 control-label no-padding-right" for="status"> 是否启用 </label>                                <div class="control-label no-padding-left col-sm-1">                                    <label>                                        <input name="status" value="1" id="status" {{if $data.status|default:1 == 1}}checked="checked"{{/if}}                                        class="ace ace-switch ace-switch-2" type="checkbox" />                                        <span class="lbl"></span>                                    </label>                                </div>                                <span class="help-inline col-xs-12 col-sm-7">												<span class="middle">YES，启用；NO，禁用</span>										</span>                            </div>                            <div class="space-4"></div>                            <div class="form-group">                                <label class="col-sm-1 control-label no-padding-right" for="remark"> 备注 </label>                                <div class="col-sm-5">                                  <textarea name="remark" id="remark" style="width:100%;height:300px;">{{$data.remark|default:''}}</textarea>                                </div>                            </div>                            <div class="col-md-offset-2 col-md-9">                                <button id="save_btn" class="btn btn-info" type="button">                                    <i class="icon-ok bigger-110"></i>                                    保存                                </button>                                &nbsp; &nbsp; &nbsp;                                <a href="javascript:history.go(-1)" class="btn" type="reset">                                    <i class="icon-undo bigger-110"></i>                                    返回                                </a>                            </div>                        </form>                        <!-- PAGE CONTENT ENDS -->                    </div><!-- /.col -->                </div><!-- /.row -->            </div><!-- /.page-content -->        </div>    </div><!-- /.main-content -->    {{include file='manager/public/footer.html'}}</div><!-- /.main-container -->{{include file='manager/public/footerjs.html'}}<!-- inline scripts related to this page --><script src="/manager_statics/qwadmin/js/date-time/bootstrap-datepicker.js"></script><script src="/manager_statics/app/select2.full.min.js"></script><script src="/manager_statics/app/ajaxfileupload.js"></script><link rel="stylesheet" href="/manager_statics/app/select2.min.css"><script>    window.onload = function() {        init();  //初始化    }    function init() {        //初始化图片上传        var btnImg = document.getElementById("btnUploadImg");        var img = document.getElementById("imgShow");        var hidImgName = document.getElementById("hidImgName");        g_AjxUploadImg(btnImg, img, hidImgName);    }    var g_AjxTempDir = "/upload_files/head/";    //图片上传    function g_AjxUploadImg(btn, img, hidPut) {        var button = btn, interval;        new AjaxUpload(button, {            action: "/ajax_api/upload_head",            data: {},            name: 'userfile',            onSubmit: function(file, ext) {                if (!(ext && /^(jpg|JPG|png|PNG|gif|GIF)$/.test(ext))) {                    alert("您上传的图片格式不对，请重新选择！");                    return false;                }            },            onComplete: function(file, response) {                flagValue = response;                if (flagValue == "1") {                    alert("您上传的图片存在错误");                }                else {                    hidPut.value = response;                    img.src = g_AjxTempDir + response;                }            }        });    }    $("#sel_member_id").select2();    $("#save_btn").click(function(){        var rel_name = $.trim($("#rel_name").val());        if(rel_name == "" ) {            layer.msg('请填写管理员姓名', {icon: 2});            return false;        }        var mobile = $.trim($("#mobile").val());        if(mobile == "" ) {            layer.msg('请填写管理员手机号码', {icon: 2});            return false;        }        var level = $("input[name='level']:checked").val();        if(level == "" ) {            layer.msg('请选择职务', {icon: 2});            return false;        }        var form = document.getElementById('save_form');        var formdata = new FormData(form);        $.ajax({            type : "POST",            url : "/manager/members_save",            data : formdata,            async: false,            cache: false,            contentType: false,            processData: false,            success : function(data) {                var return_ = JSON.parse(data)                if(return_.status == 1){                    layer.alert('操作成功', {                        skin: 'layui-layer-molv' //样式类名                        ,closeBtn: 0                    }, function(){                        window.location.replace('/manager/members_list');                    });                }else{                    layer.alert(return_.msg, {                        icon: 2,                        skin: 'layui-layer-demo'                        ,closeBtn: 0                        ,anim: 4 //动画类型                    });                }            },            error:function(){                layer.msg('网络异常!');            }        });    })    $("input[name='level']").click(function(){        var level = $("input[name='level']:checked").val();        switch (level){            case '1':            case '2':            case '4':                $("#m_div_").hide();                break;            case '3':                $("#m_div_").show();                break;        }    })</script></body></html>